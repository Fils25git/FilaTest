<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>School Management</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
/* ===== GLOBAL ===== */
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #f4f6f8;
}

.container {
  max-width: 1000px;
  margin: auto;
  padding: 15px;
}

h2, h3 {
  text-align: center;
  color: #333;
}

.section {
  background: #fff;
  padding: 15px;
  margin-bottom: 20px;
  border-radius: 10px;
  box-shadow: 0 0 10px rgba(0,0,0,0.08);
}

/* ===== FORM ELEMENTS ===== */
input, select, button {
  width: 100%;
  padding: 10px;
  margin-top: 8px;
  margin-bottom: 8px;
  border-radius: 5px;
  border: 1px solid #ccc;
  font-size: 14px;
}

button {
  background: #4CAF50;
  color: white;
  border: none;
  cursor: pointer;
}

button:hover {
  background: #45a049;
}

/* ===== LISTS ===== */
.list {
  margin-top: 10px;
}

.list-item {
  background: #f1f1f1;
  padding: 8px;
  margin-bottom: 5px;
  border-radius: 5px;
  font-size: 14px;
}

/* ===== GRID ===== */
.grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 15px;
}

/* ===== MOBILE ===== */
@media (max-width: 700px) {
  .grid {
    grid-template-columns: 1fr;
  }
}
</style>
</head>

<body>
<div class="container">

<h2>School Management</h2>

<!-- LEVELS -->
<div class="section">
  <h3>Levels</h3>
  <input type="text" id="levelName" placeholder="e.g. Primary, O'Level">
  <button onclick="addLevel()">Add Level</button>
  <div id="levelList" class="list"></div>
</div>

<!-- CLASSES -->
<div class="section">
  <h3>Classes</h3>
  <select id="classLevel"></select>
  <input type="text" id="className" placeholder="e.g. P4A, S2B">
  <button onclick="addClass()">Add Class</button>
  <div id="classList" class="list"></div>
</div>

<!-- SUBJECTS -->
<div class="section">
  <h3>Subjects</h3>
  <select id="subjectLevel"></select>
  <input type="text" id="subjectName" placeholder="e.g. Mathematics">
  <button onclick="addSubject()">Add Subject</button>
  <div id="subjectList" class="list"></div>
</div>

<!-- TEACHERS -->
<div class="section">
  <h3>Teachers</h3>
  <input type="text" id="teacherName" placeholder="Teacher name">
  <select id="teacherSubject"></select>
  <select id="teacherLevel"></select>
  <button onclick="addTeacher()">Add Teacher</button>
  <div id="teacherList" class="list"></div>
</div>

</div>

<script>
/* ===== SCHOOL CONTEXT ===== */
const currentAdmin = JSON.parse(localStorage.getItem("currentAdmin")) || { schoolId: "DEMO_SCHOOL" };
const schoolId = currentAdmin.schoolId;

/* ===== STORAGE KEYS ===== */
const levelsKey = "levels_" + schoolId;
const classesKey = "classes_" + schoolId;
const subjectsKey = "subjects_" + schoolId;
const teachersKey = "teachers_" + schoolId;

/* ===== LOAD DATA ===== */
function getData(key) {
  return JSON.parse(localStorage.getItem(key)) || [];
}

function saveData(key, data) {
  localStorage.setItem(key, JSON.stringify(data));
}

/* ===== LEVELS ===== */
function addLevel() {
  const name = levelName.value.trim();
  if (!name) return;

  const levels = getData(levelsKey);
  levels.push({ id: Date.now(), name });
  saveData(levelsKey, levels);

  levelName.value = "";
  renderAll();
}

/* ===== CLASSES ===== */
function addClass() {
  const levelId = classLevel.value;
  const name = className.value.trim();
  if (!levelId || !name) return;

  const classes = getData(classesKey);
  classes.push({ id: Date.now(), name, levelId });
  saveData(classesKey, classes);

  className.value = "";
  renderAll();
}

/* ===== SUBJECTS ===== */
function addSubject() {
  const levelId = subjectLevel.value;
  const name = subjectName.value.trim();
  if (!levelId || !name) return;

  const subjects = getData(subjectsKey);
  subjects.push({ id: Date.now(), name, levelId });
  saveData(subjectsKey, subjects);

  subjectName.value = "";
  renderAll();
}

/* ===== TEACHERS ===== */
function addTeacher() {
  const name = teacherName.value.trim();
  const subjectId = teacherSubject.value;
  const levelId = teacherLevel.value;
  if (!name || !subjectId || !levelId) return;

  const teachers = getData(teachersKey);
  teachers.push({ id: Date.now(), name, subjectId, levelId });
  saveData(teachersKey, teachers);

  teacherName.value = "";
  renderAll();
}

/* ===== RENDER ===== */
function renderAll() {
  const levels = getData(levelsKey);
  const classes = getData(classesKey);
  const subjects = getData(subjectsKey);
  const teachers = getData(teachersKey);

  // LEVEL LIST
  levelList.innerHTML = levels.map(l => `<div class="list-item">${l.name}</div>`).join("");

  // DROPDOWNS
  classLevel.innerHTML =
  subjectLevel.innerHTML =
  teacherLevel.innerHTML =
    levels.map(l => `<option value="${l.id}">${l.name}</option>`).join("");

  // CLASS LIST
  classList.innerHTML = classes.map(c => {
    const lvl = levels.find(l => l.id == c.levelId);
    return `<div class="list-item">${c.name} (${lvl?.name})</div>`;
  }).join("");

  // SUBJECT LIST
  subjectList.innerHTML = subjects.map(s => {
    const lvl = levels.find(l => l.id == s.levelId);
    return `<div class="list-item">${s.name} (${lvl?.name})</div>`;
  }).join("");

  // TEACHER SUBJECT DROPDOWN
  teacherSubject.innerHTML = subjects.map(s => `<option value="${s.id}">${s.name}</option>`).join("");

  // TEACHER LIST
  teacherList.innerHTML = teachers.map(t => {
    const subj = subjects.find(s => s.id == t.subjectId);
    const lvl = levels.find(l => l.id == t.levelId);
    return `<div class="list-item">${t.name} â€“ ${subj?.name} (${lvl?.name})</div>`;
  }).join("");
}

renderAll();
</script>
</body>
</html>
